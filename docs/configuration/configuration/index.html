<!DOCTYPE html><html lang="en-US"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><link rel="shortcut icon" href="/bazel-buildfarm/favicon.ico" type="image/x-icon"><link rel="stylesheet" href="/bazel-buildfarm/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/bazel-buildfarm/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/bazel-buildfarm/assets/js/just-the-docs.js"></script><meta name="viewport" content="width=device-width, initial-scale=1"><title>Configuration | Buildfarm</title><meta name="generator" content="Jekyll v4.1.1" /><meta property="og:title" content="Configuration" /><meta property="og:locale" content="en_US" /><meta name="description" content="Remote Execution for Bazel" /><meta property="og:description" content="Remote Execution for Bazel" /><link rel="canonical" href="https://bazelbuild.github.io/bazel-buildfarm/docs/configuration/configuration/" /><meta property="og:url" content="https://bazelbuild.github.io/bazel-buildfarm/docs/configuration/configuration/" /><meta property="og:site_name" content="Buildfarm" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Configuration" /> <script type="application/ld+json"> {"url":"https://bazelbuild.github.io/bazel-buildfarm/docs/configuration/configuration/","description":"Remote Execution for Bazel","@type":"WebPage","headline":"Configuration","@context":"https://schema.org"}</script><body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"><title>Link</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"><title>Search</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"><title>Menu</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"><title>Expand</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"><polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"><title>Document</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg><div class="side-bar"><div class="site-header"> <img src="https://bazelbuild.github.io/bazel-buildfarm/assets/images/bazel-logo.png" alt="bazel logo" style="width:53px"> <a href="https://bazelbuild.github.io/bazel-buildfarm/" class="site-title lh-tight"> Buildfarm </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a></div><nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"><ul class="nav-list"><li class="nav-list-item"><a href="https://bazelbuild.github.io/bazel-buildfarm/" class="nav-list-link">Home</a><li class="nav-list-item"><a href="https://bazelbuild.github.io/bazel-buildfarm/docs/features/" class="nav-list-link">Features</a><li class="nav-list-item"><a href="https://bazelbuild.github.io/bazel-buildfarm/docs/quick_start/" class="nav-list-link">Quick Start</a><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://bazelbuild.github.io/bazel-buildfarm/docs/configuration/configuration/" class="nav-list-link active">Configuration</a><ul class="nav-list "><li class="nav-list-item "><a href="https://bazelbuild.github.io/bazel-buildfarm/docs/configuration/authentication/" class="nav-list-link">Authentication</a></ul><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://bazelbuild.github.io/bazel-buildfarm/docs/architecture/architecture/" class="nav-list-link">Architecture</a><ul class="nav-list "><li class="nav-list-item "><a href="https://bazelbuild.github.io/bazel-buildfarm/docs/architecture/instance_types/" class="nav-list-link">Instance Types</a><li class="nav-list-item "><a href="https://bazelbuild.github.io/bazel-buildfarm/docs/architecture/workers/" class="nav-list-link">Workers</a><li class="nav-list-item "><a href="https://bazelbuild.github.io/bazel-buildfarm/docs/architecture/schedulers/" class="nav-list-link">Schedulers</a><li class="nav-list-item "><a href="https://bazelbuild.github.io/bazel-buildfarm/docs/architecture/worker-execution-environment/" class="nav-list-link">Workers</a><li class="nav-list-item "><a href="https://bazelbuild.github.io/bazel-buildfarm/docs/architecture/queues/" class="nav-list-link">Queues</a><li class="nav-list-item "><a href="https://bazelbuild.github.io/bazel-buildfarm/docs/architecture/action_cache/" class="nav-list-link">Action Cache</a><li class="nav-list-item "><a href="https://bazelbuild.github.io/bazel-buildfarm/docs/architecture/CASFileCache/" class="nav-list-link">CASFileCache</a><li class="nav-list-item "><a href="https://bazelbuild.github.io/bazel-buildfarm/docs/architecture/content_addressable_storage/" class="nav-list-link">CAS</a><li class="nav-list-item "><a href="https://bazelbuild.github.io/bazel-buildfarm/docs/architecture/redis/" class="nav-list-link">Redis</a></ul><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://bazelbuild.github.io/bazel-buildfarm/docs/execution/execution/" class="nav-list-link">Execution</a><ul class="nav-list "><li class="nav-list-item "><a href="https://bazelbuild.github.io/bazel-buildfarm/docs/execution/debugging-executions/" class="nav-list-link">Debugging</a><li class="nav-list-item "><a href="https://bazelbuild.github.io/bazel-buildfarm/docs/execution/environment/" class="nav-list-link">Environment</a><li class="nav-list-item "><a href="https://bazelbuild.github.io/bazel-buildfarm/docs/execution/exec_owner/" class="nav-list-link">Owner</a><li class="nav-list-item "><a href="https://bazelbuild.github.io/bazel-buildfarm/docs/execution/execution_limiting/" class="nav-list-link">Limiting</a><li class="nav-list-item "><a href="https://bazelbuild.github.io/bazel-buildfarm/docs/execution/builds-without-the-bytes/" class="nav-list-link">Build Without Bytes</a><li class="nav-list-item "><a href="https://bazelbuild.github.io/bazel-buildfarm/docs/execution/execution_properties/" class="nav-list-link">Properties</a><li class="nav-list-item "><a href="https://bazelbuild.github.io/bazel-buildfarm/docs/execution/execution_policies/" class="nav-list-link">Policies</a></ul><li class="nav-list-item"><a href="https://bazelbuild.github.io/bazel-buildfarm/docs/security/security/" class="nav-list-link">Security</a><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://bazelbuild.github.io/bazel-buildfarm/docs/metrics/metrics/" class="nav-list-link">Metrics</a><ul class="nav-list "><li class="nav-list-item "><a href="https://bazelbuild.github.io/bazel-buildfarm/docs/metrics/alerts/" class="nav-list-link">Alerts</a></ul><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://bazelbuild.github.io/bazel-buildfarm/docs/tools/tools/" class="nav-list-link">Tools</a><ul class="nav-list "><li class="nav-list-item "><a href="https://bazelbuild.github.io/bazel-buildfarm/docs/tools/troubleshooting-bazel-remote-execution/" class="nav-list-link">Troubleshooting</a><li class="nav-list-item "><a href="https://bazelbuild.github.io/bazel-buildfarm/docs/tools/bf-cat/" class="nav-list-link">bf-cat</a></ul><li class="nav-list-item"><a href="https://bazelbuild.github.io/bazel-buildfarm/docs/admin/" class="nav-list-link">Admin</a><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://bazelbuild.github.io/bazel-buildfarm/docs/contribute/contribute/" class="nav-list-link">Contribute</a><ul class="nav-list "><li class="nav-list-item "><a href="https://bazelbuild.github.io/bazel-buildfarm/docs/contribute/local_development/" class="nav-list-link">Local Development</a><li class="nav-list-item "><a href="https://bazelbuild.github.io/bazel-buildfarm/docs/contribute/design-documents/" class="nav-list-link">Design Documents</a></ul></ul></nav><footer class="site-footer"></footer></div><div class="main" id="top"><div id="main-header" class="main-header"><div class="search"><div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Buildfarm" aria-label="Search Buildfarm" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label></div><div id="search-results" class="search-results"></div></div><nav aria-label="Auxiliary" class="aux-nav"><ul class="aux-nav-list"><li class="aux-nav-list-item"> <a href="https://github.com/bazelbuild/bazel-buildfarm" class="site-button" > GitHub </a></ul></nav></div><div id="main-content-wrap" class="main-content-wrap"><div id="main-content" class="main-content" role="main"><p>Minimal required:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>backplane:
  redisUri: "redis://localhost:6379"
  queues:
    - name: "cpu"
      properties:
        - name: "min-cores"
          value: "*"
        - name: "max-cores"
          value: "*"
worker:
  publicName: "localhost:8981"
</code></pre></div></div><p>The configuration can be provided to the server and worker as a CLI argument or through the env variable <code class="language-plaintext highlighter-rouge">CONFIG_PATH</code> For an example config containing all of the configuration values, see <code class="language-plaintext highlighter-rouge">examples/config.yml</code>.</p><h2 id="all-configurations"> <a href="#all-configurations" class="anchor-heading" aria-labelledby="all-configurations"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> All Configurations</h2><h3 id="common"> <a href="#common" class="anchor-heading" aria-labelledby="common"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Common</h3><div class="table-wrapper"><table><thead><tr><th>Configuration<th>Accepted and <em>Default</em> Values<th>Description<tbody><tr><td>digestFunction<td><em>SHA256</em>, SHA1<td>Digest function for this implementation<tr><td>defaultActionTimeout<td>Integer, <em>600</em><td>Default timeout value for an action (seconds)<tr><td>maximumActionTimeout<td>Integer, <em>3600</em><td>Maximum allowed action timeout (seconds)<tr><td>maxEntrySizeBytes<td>Long, <em>2147483648</em><td>Maximum size of a single blob accepted (bytes)<tr><td>prometheusPort<td>Integer, <em>9090</em><td>Listening port of the Prometheus metrics endpoint</table></div><p>Example:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>digestFunction: SHA1
defaultActionTimeout: 1800
maximumActionTimeout: 1800
prometheusPort: 9090
server:
  ...
worker:
  ...
</code></pre></div></div><h3 id="server"> <a href="#server" class="anchor-heading" aria-labelledby="server"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Server</h3><div class="table-wrapper"><table><thead><tr><th>Configuration<th>Accepted and <em>Default</em> Values<th>Environment Var<th>Description<tbody><tr><td>instanceType<td><em>SHARD</em><td> <td>Type of implementation (SHARD is the only one supported)<tr><td>name<td>String, <em>shard</em><td> <td>Implementation name<tr><td>publicName<td>String, <em>DERIVED:port</em><td>INSTANCE_NAME<td>Host:port of the GRPC server, required to be accessible by all servers<tr><td>actionCacheReadOnly<td>boolean, <em>false</em><td> <td>Allow/Deny writing to action cache<tr><td>port<td>Integer, <em>8980</em><td> <td>Listening port of the GRPC server<tr><td>casWriteTimeout<td>Integer, <em>3600</em><td> <td>CAS write timeout (seconds)<tr><td>bytestreamTimeout<td>Integer, <em>3600</em><td> <td>Byte Stream write timeout (seconds)<tr><td>sslCertificatePath<td>String, <em>null</em><td> <td>Absolute path of the SSL certificate (if TLS used)<tr><td>sslPrivateKeyPath<td>String, <em>null</em><td> <td>Absolute path of the SSL private key (if TLS used)<tr><td>runDispatchedMonitor<td>boolean, <em>true</em><td> <td>Enable an agent to monitor the operation store to ensure that dispatched operations with expired worker leases are requeued<tr><td>dispatchedMonitorIntervalSeconds<td>Integer, <em>1</em><td> <td>Dispatched monitor’s lease expiration check interval (seconds)<tr><td>runOperationQueuer<td>boolean, <em>true</em><td> <td>Aquire execute request entries cooperatively from an arrival queue on the backplane<tr><td>ensureOutputsPresent<td>boolean, <em>false</em><td> <td>Decide if all outputs are also present in the CAS. If any outputs are missing a cache miss is returned<tr><td>maxCpu<td>Integer, <em>0</em><td> <td>Maximum number of CPU cores that any min/max-cores property may request (0 = unlimited)<tr><td>maxRequeueAttempts<td>Integer, <em>5</em><td> <td>Maximum number of requeue attempts for an operation<tr><td>useDenyList<td>boolean, <em>true</em><td> <td>Allow usage of a deny list when looking up actions and invocations (for cache only it is recommended to disable this check)<tr><td>grpcTimeout<td>Integer, <em>3600</em><td> <td>GRPC request timeout (seconds)<tr><td>executeKeepaliveAfterSeconds<td>Integer, <em>60</em><td> <td>Execute keep alive (seconds)<tr><td>recordBesEvents<td>boolean, <em>false</em><td> <td>Allow recording of BES events<tr><td>clusterId<td>String, <em>local</em><td> <td>Buildfarm cluster ID<tr><td>cloudRegion<td>String, <em>us-east_1</em><td> <td>Deployment region in the cloud</table></div><p>Example:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>server:
  instanceType: SHARD
  name: shard
  actionCacheReadOnly: true
  recordBesEvents: true
</code></pre></div></div><h3 id="grpc-metrics"> <a href="#grpc-metrics" class="anchor-heading" aria-labelledby="grpc-metrics"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> GRPC Metrics</h3><div class="table-wrapper"><table><thead><tr><th>Configuration<th>Accepted and <em>Default</em> Values<th>Description<tbody><tr><td>enabled<td>boolean, <em>false</em><td>Publish basic GRPC metrics to a Prometheus endpoint<tr><td>provideLatencyHistograms<td>boolean, <em>false</em><td>Publish detailed, more expensive to calculate, metrics</table></div><p>Example:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>server:
  grpcMetrics:
    enabled: false
    provideLatencyHistograms: false
</code></pre></div></div><h3 id="server-caches"> <a href="#server-caches" class="anchor-heading" aria-labelledby="server-caches"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Server Caches</h3><div class="table-wrapper"><table><thead><tr><th>Configuration<th>Accepted and <em>Default</em> Values<th>Description<tbody><tr><td>directoryCacheMaxEntries<td>Long, <em>64 * 1024</em><td>The max number of entries that the directory cache will hold.<tr><td>commandCacheMaxEntries<td>Long, <em>64 * 1024</em><td>The max number of entries that the command cache will hold.<tr><td>digestToActionCacheMaxEntries<td>Long, <em>64 * 1024</em><td>The max number of entries that the digest-to-action cache will hold.<tr><td>recentServedExecutionsCacheMaxEntries<td>Long, <em>64 * 1024</em><td>The max number of entries that the executions cache will hold.</table></div><p>Example:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>server:
  caches:
    directoryCacheMaxEntries: 10000
    commandCacheMaxEntries: 10000
    digestToActionCacheMaxEntries: 10000
    recentServedExecutionsCacheMaxEntries: 10000
</code></pre></div></div><h3 id="admin"> <a href="#admin" class="anchor-heading" aria-labelledby="admin"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Admin</h3><div class="table-wrapper"><table><thead><tr><th>Configuration<th>Accepted and <em>Default</em> Values<th>Description<tbody><tr><td>deploymentEnvironment<td>String, AWS, GCP<td>Specify deloyment environment in the cloud<tr><td>clusterEndpoint<td>String, grpc://localhost<td>Buildfarm cluster endpoint for Admin use (this is a full buildfarm endpoint)</table></div><p>Example:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>server:
  admin:
    deploymentEnvironment: AWS
    clusterEndpoint: "grpc://localhost"
</code></pre></div></div><h3 id="metrics"> <a href="#metrics" class="anchor-heading" aria-labelledby="metrics"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metrics</h3><div class="table-wrapper"><table><thead><tr><th>Configuration<th>Accepted and <em>Default</em> Values<th>Description<tbody><tr><td>publisher<td>String, aws, gcp, <em>log</em><td>Specify publisher type for sending metadata<tr><td>logLevel<td>String, INFO, <em>FINEST</em><td>Specify log level (“log” publisher only, all Java util logging levels are allowed here)<tr><td>topic<td>String, <em>test</em><td>Specify SNS topic name for cloud publishing (“aws” publisher only)<tr><td>topicMaxConnections<td>Integer, 1000<td>Specify maximum number of connections allowed for cloud publishing (“aws” publisher only)<tr><td>secretName<td>String, <em>test</em><td>Specify secret name to pull SNS permissions from (“aws” publisher only)</table></div><p>Example:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>server:
  metrics:
    publisher: log
    logLevel: INFO
</code></pre></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>server:
  metrics:
    publisher: aws
    topic: buildfarm-metadata-test
    topicMaxConnections: 1000
    secretName: buildfarm-secret
</code></pre></div></div><h3 id="redis-backplane"> <a href="#redis-backplane" class="anchor-heading" aria-labelledby="redis-backplane"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Redis Backplane</h3><div class="table-wrapper"><table><thead><tr><th>Configuration<th>Accepted and <em>Default</em> Values<th>Environment Var<th>Description<tbody><tr><td>type<td><em>SHARD</em><td> <td>Type of backplane. Currently, the only implemntation is SHARD utilizing Redis<tr><td>redisUri<td>String, redis://localhost:6379<td>REDIS_URI<td>Redis cluster endpoint. This must be a single URI<tr><td>redisPassword<td>String, <em>null</em><td> <td>Redis password, if applicable<tr><td>redisNodes<td>List of Strings, <em>null</em><td> <td>List of individual Redis nodes, if applicable<tr><td>jedisPoolMaxTotal<td>Integer, <em>4000</em><td> <td>The size of the Redis connection pool<tr><td>workersHashName<td>String, <em>Workers</em><td> <td>Redis key used to store a hash of registered workers<tr><td>workerChannel<td>String, <em>WorkerChannel</em><td> <td>Redis pubsub channel key where changes of the cluster membership are announced<tr><td>actionCachePrefix<td>String, <em>ActionCache</em><td> <td>Redis key prefix for all ActionCache entries<tr><td>actionCacheExpire<td>Integer, <em>2419200</em><td> <td>The TTL maintained for ActionCache entries, not refreshed on getActionResult hit<tr><td>actionBlacklistPrefix<td>String, <em>ActionBlacklist</em><td> <td>Redis key prefix for all blacklisted actions, which are rejected<tr><td>actionBlacklistExpire<td>Integer, <em>3600</em><td> <td>The TTL maintained for action blacklist entries<tr><td>invocationBlacklistPrefix<td>String, <em>InvocationBlacklist</em><td> <td>Redis key prefix for blacklisted invocations, suffixed with a a tool invocation ID<tr><td>operationPrefix<td>String, <em>Operation</em><td> <td>Redis key prefix for all operations, suffixed wtih the operation’s name<tr><td>operationExpire<td>Integer, <em>604800</em><td> <td>The TTL maintained for all operations, updated on each modification<tr><td>preQueuedOperationsListName<td>String, <em>{Arrival}:PreQueuedOperations</em><td> <td>Redis key used to store a list of ExecuteEntry awaiting transformation into QueryEntry<tr><td>processingListName<td>String, <em>{Arrival}:ProcessingOperations</em><td> <td>Redis key of a list used to ensure reliable processing of arrival queue etries with operation watch monitoring<tr><td>processingPrefix<td>String, <em>Processing</em><td> <td>Redis key prefix for operations which are being dequeued from the arrival queue<tr><td>processingTimeoutMillis<td>Integer, <em>20000</em><td> <td>Delay (in ms) used to populate processing operation entries<tr><td>queuedOperationsListName<td>String, <em>{Execution}:QueuedOperations</em><td> <td>Redis key used to store a list of QueueEntry awaiting execution by workers<tr><td>dispatchingPrefix<td>String, <em>Dispatching</em><td> <td>Redis key prefix for operations which are being dequeued from the ready to run queue<tr><td>dispatchingTimeoutMillis<td>Integer, <em>10000</em><td> <td>Delay (in ms) used to populate dispatching operation entries<tr><td>dispatchedOperationsHashName<td>String, <em>DispatchedOperations</em><td> <td>Redis key of a hash of operation names to the worker lease for its execution, which are monitored by the dispatched monitor<tr><td>operationChannelPrefix<td>String, <em>OperationChannel</em><td> <td>Redis pubsub channel prefix suffixed by an operation name<tr><td>casPrefix<td>String, <em>ContentAddressableStorage</em><td> <td>Redis key prefix suffixed with a blob digest that maps to a set of workers with that blob’s availability<tr><td>casExpire<td>Integer, <em>604800</em><td> <td>The TTL maintained for CAS entries, which is not refreshed on any read access of the blob<tr><td>subscribeToBackplane<td>boolean, <em>true</em><td> <td>Enable an agent of the backplane client which subscribes to worker channel and operation channel events. If disabled, responsiveness of watchers and CAS are reduced<tr><td>runFailsafeOperation<td>boolean, <em>true</em><td> <td>Enable an agent in the backplane client which monitors watched operations and ensures they are in a known maintained, or expirable state<tr><td>maxQueueDepth<td>Integer, <em>100000</em><td> <td>Maximum length that the ready to run queue is allowed to reach to control an arrival flow for execution<tr><td>maxPreQueueDepth<td>Integer, <em>1000000</em><td> <td>Maximum lengh that the arrival queue is allowed to reach to control load on the Redis cluster<tr><td>priorityQueue<td>boolean, <em>false</em><td> <td>Priority queue type allows prioritizing operations based on Bazel’s –remote_execution_priority=<an integer=""> flag</an><tr><td>timeout<td>Integer, <em>10000</em><td> <td>Default timeout<tr><td>maxAttempts<td>Integer, <em>20</em><td> <td>Maximum number of execution attempts<tr><td>cacheCas<td>boolean, <em>false</em><td> <td> </table></div><p>Example:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>backplane:
  type: SHARD
  redisUri: "redis://localhost:6379"
  priorityQueue: true
</code></pre></div></div><h3 id="execution-queues"> <a href="#execution-queues" class="anchor-heading" aria-labelledby="execution-queues"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Execution Queues</h3><div class="table-wrapper"><table><thead><tr><th>Configuration<th>Accepted and <em>Default</em> Values<th>Description<tbody><tr><td>name<td>String<td>Name of the execution queue (ex: cpu, gpu)<tr><td>allowUnmatched<td>boolean, <em>true</em><td> <tr><td>properties<td>List of name/value pairs<td>Any specification of min/max-cores will be allowed to support CPU controls and worker resource delegation</table></div><p>Example:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>backplane:
  type: SHARD
  redisUri: "redis://localhost:6379"
  queues:
    - name: "cpu"
      allowUnmatched: true
      properties:
        - name: "min-cores"
          value: "*"
        - name: "max-cores"
          value: "*"
</code></pre></div></div><h3 id="worker"> <a href="#worker" class="anchor-heading" aria-labelledby="worker"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Worker</h3><div class="table-wrapper"><table><thead><tr><th>Configuration<th>Accepted and <em>Default</em> Values<th>Environment Var<th>Description<tbody><tr><td>port<td>Integer, <em>8981</em><td> <td>Listening port of the worker<tr><td>publicName<td>String, <em>DERIVED:port</em><td>INSTANCE_NAME<td>Host:port of the GRPC server, required to be accessible by all servers<tr><td>root<td>String, <em>/tmp/worker</em><td> <td>Path for all operation content storage<tr><td>inlineContentLimit<td>Integer, <em>1048567</em><td> <td>Total size in bytes of inline content for action results, output files, stdout, stderr content<tr><td>operationPollPeriod<td>Integer, <em>1</em><td> <td>Period between poll operations at any stage<tr><td>executeStageWidth<td>Integer, <em>0</em><td>EXECUTION_STAGE_WIDTH<td>Number of CPU cores available for execution (0 = system available cores)<tr><td>executeStageWidthOffset<td>Integer, <em>0</em><td> <td>Offset number of CPU cores available for execution (to allow for use by other processes)<tr><td>inputFetchStageWidth<td>Integer, <em>0</em><td> <td>Number of concurrently available slots to fetch inputs (0 = system calculated based on CPU cores)<tr><td>inputFetchDeadline<td>Integer, <em>60</em><td> <td>Limit on time (seconds) for input fetch stage to fetch inputs<tr><td>linkInputDirectories<td>boolean, <em>true</em><td> <td>Use an input directory creation strategy which creates a single directory tree at the highest level containing no output paths of any kind, and symlinks that directory into an action’s execroot, saving large amounts of time spent manufacturing the same read-only input hierirchy over multiple actions’ executions<tr><td>execOwner<td>String, <em>null</em><td> <td>Create exec trees containing directories that are owned by this user<tr><td>hexBucketLevels<td>Integer, <em>0</em><td> <td>Number of levels to create for directory storage by leading byte of the hash (problematic, not recommended)<tr><td>defaultMaxCores<td>Integer, <em>0</em><td> <td>Constrain all executions to this logical core count unless otherwise specified via min/max-cores (0 = no limit)<tr><td>limitGlobalExecution<td>boolean, <em>false</em><td> <td>Constrain all executions to a pool of logical cores specified in executeStageWidth<tr><td>onlyMulticoreTests<td>boolean, <em>false</em><td> <td>Only permit tests to exceed the default coresvalue for their min/max-cores range specification (only works with non-zero defaultMaxCores)<tr><td>allowBringYourOwnContainer<td>boolean, <em>false</em><td> <td>Enable execution in a custom Docker container<tr><td>errorOperationRemainingResources<td>boolean, <em>false</em><td> <td> <tr><td>realInputDirectories<td>List of Strings, <em>external</em><td> <td>A list of paths that will not be subject to the effects of linkInputDirectories setting, may also be used to provide writable directories as input roots for actions which expect to be able to write to an input location and will fail if they cannot</table></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>worker:
  port: 8981
  publicName: "localhost:8981"
  realInputDirectories:
    - "external"
</code></pre></div></div><h3 id="capabilities"> <a href="#capabilities" class="anchor-heading" aria-labelledby="capabilities"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Capabilities</h3><div class="table-wrapper"><table><thead><tr><th>Configuration<th>Accepted and <em>Default</em> Values<th>Description<tbody><tr><td>cas<td>boolean, <em>true</em><td>Enables worker to be a shard of the CAS<tr><td>execution<td>boolean, <em>true</em><td>Enables worker to participate in execution pool</table></div><p>Example:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>worker:
  capabilities:
    cas: true
    execution: true
</code></pre></div></div><h3 id="sandbox-settings"> <a href="#sandbox-settings" class="anchor-heading" aria-labelledby="sandbox-settings"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Sandbox Settings</h3><div class="table-wrapper"><table><thead><tr><th>Configuration<th>Accepted and <em>Default</em> Values<th>Description<tbody><tr><td>alwaysUse<td>boolean, <em>false</em><td>Enforce that the sandbox be used on every acion.<tr><td>selectForBlockNetwork<td>boolean, <em>false</em><td><code class="language-plaintext highlighter-rouge">block-network</code> enables sandbox action execution.<tr><td>selectForTmpFs<td>boolean, <em>false</em><td><code class="language-plaintext highlighter-rouge">tmpfs</code> enables sandbox action execution.</table></div><p>Example:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>worker:
  sandboxSettings:
    alwaysUse: true
    selectForBlockNetwork: false
    selectForTmpFs: false
</code></pre></div></div><h3 id="dequeue-match"> <a href="#dequeue-match" class="anchor-heading" aria-labelledby="dequeue-match"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Dequeue Match</h3><div class="table-wrapper"><table><thead><tr><th>Configuration<th>Accepted and <em>Default</em> Values<th>Description<tbody><tr><td>acceptEverything<td>boolean, <em>true</em><td> <tr><td>allowUnmatched<td>boolean, <em>false</em><td> </table></div><p>Example:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>worker:
  dequeueMatchSettings:
    acceptEverything: true
    allowUnmatched: false
</code></pre></div></div><h3 id="worker-cas"> <a href="#worker-cas" class="anchor-heading" aria-labelledby="worker-cas"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Worker CAS</h3><div class="table-wrapper"><table><thead><tr><th>Configuration<th>Accepted and <em>Default</em> Values<th>Description<tbody><tr><td>type<td><em>FILESYSTEM</em>, GRPC<td>Type of CAS used<tr><td>path<td>String, <em>cache</em><td>Local cache location relative to the ‘root’, or absolute<tr><td>maxSizeBytes<td>Integer, <em>2147483648</em><td>Limit for contents of files retained from CAS in the cache<tr><td>fileDirectoriesIndexInMemory<td>boolean, <em>false</em><td>Determines if the file directories bidirectional mapping should be stored in memory or in sqllite<tr><td>skipLoad<td>boolean, <em>false</em><td>Determines if transient data on the worker should be loaded into CAS on worker startup (affects startup time)<tr><td>target<td>String, <em>null</em><td>For GRPC CAS type, target for external CAS endpoint</table></div><p>Example:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>worker:
  cas:
    type: FILESYSTEM
    path: "cache"
    maxSizeBytes: 2147483648 # 2 * 1024 * 1024 * 1024
    maxEntrySizeBytes: 2147483648 # 2 * 1024 * 1024 * 1024
    target:
</code></pre></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>worker:
  cas:
    type: GRPC
    instanceName: external-cas
    target: "cas.external.com:1234"
</code></pre></div></div><h3 id="execution-policies"> <a href="#execution-policies" class="anchor-heading" aria-labelledby="execution-policies"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Execution Policies</h3><div class="table-wrapper"><table><thead><tr><th>Configuration<th>Accepted and <em>Default</em> Values<th>Description<tbody><tr><td>name<td>String<td>Execution policy name<tr><td>executionWrapper<td>Execution wrapper, containing a path and list of arguments<td>Execution wrapper, its path and a list of arguments for the wrapper</table></div><p>Example:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>worker:
  executionPolicies:
    - name: test
      executionWrapper:
        path: /
        arguments:
          - arg1
          - arg2
</code></pre></div></div><hr><h2 class="text-delta">Table of contents</h2><ul><li> <a href="https://bazelbuild.github.io/bazel-buildfarm/docs/configuration/authentication/">Authentication</a></ul><hr><footer><p class="text-small text-grey-dk-100 mb-0"></p><div class="d-flex mt-2"><p class="text-small text-grey-dk-000 mb-0"> <a href="https://github.com/bazelbuild/bazel-buildfarm/edit/main/_site/docs/configuration/configuration.md" id="edit-this-page">Edit on GitHub</a></p></div></footer></div></div><div class="search-overlay"></div></div>
